
### Project Structure

```
├── packages/                    
│   ├── server/             # Backend
│   │   ├── docs/           
│   │   │   ├── api-v1.json # Generate by command `gdoc`
│   │   │   └── ...
│   │   ├── src/
│   │   │   ├── api-v1/  #api folder group by version
│   │   │   │   ├── get/  # endpoint group by http method 
│   │   └── ...
│   │   ├── types/          # Utility types
│   │   └── ...
│   ├── shared-types/        
│   │   ├── pure.d.ts       # Generated by command `gtype`
│   │   └── ...
│   ├── web/                # Frontend
│   │   ├── api/            # API client
│   │   └── ...
│   └── ...
└── ...
```

### Conventions 
1. One file per endpoint\
   Example: `POST /api/v1/user/login` -> `api-v1/post/user/login.ts`

2. Declare handler function types using `AuthedHandler` or `OpenHandler`
   ```ts
   interface LoginPayload {
     account: string
     password: string
   }
   type ApiType = AuthedHandler<{body:LoginPayload}, { token: string }>

   const handler: ApiType = async (_req, res) => {
     res.send({ token: 'mock token' })
   }
   ```
3. Always `export default` a handler funciton or a array of handler functions
   ```ts 
   export default handler
   ```

4. Keep index files in sync (api-v1/index.ts, api-v1/[method]/index.ts)
It is recommended to use `npx v1 -a` to automatically sync them.
   ```ts 
     export default { // api-v1/index.ts
       'post': import('./post/index.js'),
     } 
   ```
   ```ts 
     export default { //  api-v1/post/index.ts
       '/login': import('./login.js'),
     }
   ```


### Document Resources

[Tealina](https://www.tealina.dev),
[Primsa](https://www.prisma.io),
[Vitest](https://www.vitest.dev),
[Zod](https://www.zod.dev)

### Editor Setup

Install [Prisma extension](https://www.prisma.io/docs/guides/development-environment/editor-setup) for better development experience

### If you only use Primsa for generate type

1. Remove Prisma dependencies.
   eg:

```bash
pnpm remove prisma @prisma/client
```
